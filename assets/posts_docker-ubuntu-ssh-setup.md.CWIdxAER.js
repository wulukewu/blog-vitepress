import{_ as a,o as i,c as e,a8 as t}from"./chunks/framework.D1nT80TK.js";const u=JSON.parse('{"title":"Docker - Ubuntu SSH Setup","description":"","frontmatter":{"title":"Docker - Ubuntu SSH Setup","date":"2024-11-20T20:51:19.000Z","tags":["docker","ubuntu","ssh","devops","containerization","linux","tutorial"],"lastUpdated":"2025-04-03T15:32:30.000Z"},"headers":[],"relativePath":"posts/docker-ubuntu-ssh-setup.md","filePath":"posts/docker-ubuntu-ssh-setup.md"}'),n={name:"posts/docker-ubuntu-ssh-setup.md"};function h(l,s,r,p,o,k){return i(),e("div",{"data-pagefind-body":!0,"data-pagefind-meta":"date:1732135879000"},[...s[0]||(s[0]=[t(`<h1 id="docker-ubuntu-ssh-setup" tabindex="-1">Docker - Ubuntu SSH Setup <a class="header-anchor" href="#docker-ubuntu-ssh-setup" aria-label="Permalink to &quot;Docker - Ubuntu SSH Setup&quot;">​</a></h1><p><strong>Host</strong>: Use the same port -&gt; just change to the SSH port that does not conflict with NAS.</p><h2 id="environment-settings-for-ubuntu-container" tabindex="-1">Environment Settings for Ubuntu Container <a class="header-anchor" href="#environment-settings-for-ubuntu-container" aria-label="Permalink to &quot;Environment Settings for Ubuntu Container&quot;">​</a></h2><h3 id="dockerfile" tabindex="-1">Dockerfile <a class="header-anchor" href="#dockerfile" aria-label="Permalink to &quot;Dockerfile&quot;">​</a></h3><div class="language-dockerfile vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">dockerfile</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ubuntu:latest</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RUN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> apt-get update &amp;&amp; apt-get install -y openssh-server</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RUN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mkdir /var/run/sshd</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RUN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> echo </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;root:your_password&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> | chpasswd</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RUN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sed -i </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;s/PermitRootLogin prohibit-password/PermitRootLogin yes/&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /etc/ssh/sshd_config</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RUN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sed </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;s@session</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">*required</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">*pam_loginuid.so@session optional pam_loginuid.so@g&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -i /etc/pam.d/sshd</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Other installations</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RUN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> apt-get upgrade -y</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RUN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> apt-get install -y sudo nano vim curl git</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">EXPOSE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 22</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CMD</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/usr/sbin/sshd&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;-D&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre></div><h3 id="docker-build-and-push-to-docker-hub" tabindex="-1">Docker Build and Push to Docker Hub <a class="header-anchor" href="#docker-build-and-push-to-docker-hub" aria-label="Permalink to &quot;Docker Build and Push to Docker Hub&quot;">​</a></h3><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -t</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ubuntu_ssh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> .</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tag</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ubuntu_ssh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> wulukewu/ubuntu_ssh:latest</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> push</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> wulukewu/ubuntu_ssh:latest</span></span></code></pre></div><h3 id="install-openssh-server" tabindex="-1">Install OpenSSH-Server <a class="header-anchor" href="#install-openssh-server" aria-label="Permalink to &quot;Install OpenSSH-Server&quot;">​</a></h3><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apt-get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apt-get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> openssh-server</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkdir</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /var/run/sshd</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;root:your_password&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> chpasswd</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sed</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;s/PermitRootLogin prohibit-password/PermitRootLogin yes/&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/ssh/sshd_config</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;s@session\\s*required\\s*pam_loginuid.so@session optional pam_loginuid.so@g&#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/pam.d/sshd</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/usr/sbin/sshd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -D</span></span></code></pre></div><hr><h2 id="pull-and-run-the-ubuntu-ssh-image" tabindex="-1">Pull and Run the ubuntu_ssh Image <a class="header-anchor" href="#pull-and-run-the-ubuntu-ssh-image" aria-label="Permalink to &quot;Pull and Run the ubuntu_ssh Image&quot;">​</a></h2><h3 id="pull-ubuntu-ssh-from-docker-hub" tabindex="-1">Pull ubuntu_ssh from Docker Hub <a class="header-anchor" href="#pull-ubuntu-ssh-from-docker-hub" aria-label="Permalink to &quot;Pull ubuntu_ssh from Docker Hub&quot;">​</a></h3><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pull</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> wulukewu/ubuntu_ssh:latest</span></span></code></pre></div><h3 id="run-ubuntu-ssh-in-host" tabindex="-1">Run ubuntu_ssh in Host <a class="header-anchor" href="#run-ubuntu-ssh-in-host" aria-label="Permalink to &quot;Run ubuntu_ssh in Host&quot;">​</a></h3><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --net=host</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ubuntu_ssh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> wulukewu/ubuntu_ssh:latest</span></span></code></pre></div><h3 id="access-the-ubuntu-container" tabindex="-1">Access the Ubuntu Container <a class="header-anchor" href="#access-the-ubuntu-container" aria-label="Permalink to &quot;Access the Ubuntu Container&quot;">​</a></h3><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> exec</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -t</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ubuntu_ssh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /bin/bash</span></span></code></pre></div><hr><h2 id="hostname-configuration" tabindex="-1">Hostname Configuration <a class="header-anchor" href="#hostname-configuration" aria-label="Permalink to &quot;Hostname Configuration&quot;">​</a></h2><h3 id="change-hostname" tabindex="-1">Change Hostname <a class="header-anchor" href="#change-hostname" aria-label="Permalink to &quot;Change Hostname&quot;">​</a></h3><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nano</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/hostname</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nano</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/hosts</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> reboot</span></span></code></pre></div><h3 id="display-the-current-hostname" tabindex="-1">Display the Current Hostname <a class="header-anchor" href="#display-the-current-hostname" aria-label="Permalink to &quot;Display the Current Hostname&quot;">​</a></h3><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">hostname</span></span></code></pre></div><hr><h2 id="ssh-configuration" tabindex="-1">SSH Configuration <a class="header-anchor" href="#ssh-configuration" aria-label="Permalink to &quot;SSH Configuration&quot;">​</a></h2><h3 id="change-ssh-port" tabindex="-1">Change SSH Port <a class="header-anchor" href="#change-ssh-port" aria-label="Permalink to &quot;Change SSH Port&quot;">​</a></h3><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nano</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/ssh/sshd_config</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">service</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ssh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span></span></code></pre></div><hr><h2 id="user-management" tabindex="-1">User Management <a class="header-anchor" href="#user-management" aria-label="Permalink to &quot;User Management&quot;">​</a></h2><h3 id="add-a-new-sudo-user" tabindex="-1">Add a New Sudo User <a class="header-anchor" href="#add-a-new-sudo-user" aria-label="Permalink to &quot;Add a New Sudo User&quot;">​</a></h3><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">adduser</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> user_name</span></span></code></pre></div><h3 id="add-the-user-to-the-sudo-group" tabindex="-1">Add the User to the Sudo Group <a class="header-anchor" href="#add-the-user-to-the-sudo-group" aria-label="Permalink to &quot;Add the User to the Sudo Group&quot;">​</a></h3><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">usermod</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -aG</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> user_name</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">usermod</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -aG</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> root</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> user_name</span></span></code></pre></div><h3 id="change-user-password" tabindex="-1">Change User Password <a class="header-anchor" href="#change-user-password" aria-label="Permalink to &quot;Change User Password&quot;">​</a></h3><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> passwd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> user_name</span></span></code></pre></div><h3 id="test-sudo-access" tabindex="-1">Test Sudo Access <a class="header-anchor" href="#test-sudo-access" aria-label="Permalink to &quot;Test Sudo Access&quot;">​</a></h3><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">su</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> user_name</span></span></code></pre></div><hr><h2 id="references" tabindex="-1">References <a class="header-anchor" href="#references" aria-label="Permalink to &quot;References&quot;">​</a></h2><ul><li><a href="https://www.cherryservers.com/blog/ssh-into-docker-container" target="_blank" rel="noreferrer">How to SSH into a Docker Container | Step-by-Step Tutorial</a></li><li><a href="https://peihsinsu.gitbooks.io/docker-note-book/content/docker-save-image.html" target="_blank" rel="noreferrer">Save Docker Image as a File</a></li><li><a href="https://www.cyberciti.biz/faq/ubuntu-change-hostname-command/" target="_blank" rel="noreferrer">Ubuntu Linux Change Hostname</a></li><li><a href="https://ithelp.ithome.com.tw/articles/10193457" target="_blank" rel="noreferrer">Day 21: Introduction to Docker Networking (Part 2)</a></li><li><a href="https://yingclin.github.io/2018/docker-basic.html" target="_blank" rel="noreferrer">Docker Basic Commands Cheat Sheet</a></li><li><a href="https://www.digitalocean.com/community/tutorials/how-to-create-a-new-sudo-enabled-user-on-ubuntu" target="_blank" rel="noreferrer">How to Create a New Sudo-Enabled User on Ubuntu</a></li><li><a href="https://askubuntu.com/questions/423942/change-password-on-root-user-and-user-account" target="_blank" rel="noreferrer">Change Password for Root and User Accounts</a></li><li><a href="https://chatgpt.com/share/673dd661-36a0-8007-8442-b5d1cb04bebd" target="_blank" rel="noreferrer">Ask ChatGPT</a></li></ul>`,40)])])}const c=a(n,[["render",h]]);export{u as __pageData,c as default};
